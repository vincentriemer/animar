!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.Animar=n()}(this,function(){"use strict";function t(t,n){return n={exports:{}},t(n,n.exports,k),n.exports}function n(t,n){var e=n.currentIteration,r=n.totalIterations,i=n.easingFunction,o=n.startValue,a=n.changeInValue;return e<0?e=0:e>r&&(e=r),t+i(e,o,a,r)}function e(t){return t.reduce(n,0)}function r(t){return function(n){var e=n.currentIteration,r=n.totalIterations,i=n.wait,o=n.delay,a=n.looping;return e<r+i?n.merge({currentIteration:e+t}):a?n.merge({currentIteration:0-o}):null}}function i(t){return function(n){return n.merge({looping:!0,wait:t.totalDuration-n.delay-n.totalIterations})}}function o(t,n,e,r,i,o){return A.from({currentIteration:t,startValue:n,changeInValue:e,totalIterations:r,easingFunction:i,delay:o,looping:T.looping,wait:T.wait})}function a(t){return function(n){return n.merge({animations:n.animations.concat([t])})}}function u(t){return function(n){return n.merge({model:t.model,animations:n.animations.concat(t.animations)})}}function c(t){return function(n){return n.merge({animations:n.animations.map(r(t)).filter(function(t){return t})})}}function l(t){return function(n){return n.merge({animations:n.animations.map(i(t))})}}function s(t){return t.model+e(t.animations)}function f(t){return A.from({model:t,animations:A.from([])})}function p(t){var n=[],e=!0,r=!1,i=void 0;try{for(var o,a=Object.keys(t)[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var u=o.value;n.push([u,t[u]])}}catch(t){r=!0,i=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw i}}return n}function d(t){return function(n,e){return p(t).reduce(function(t,e){var r=R(e,2),i=r[0],o=r[1];return n(t,o,i)},e)}}function h(t){return function(n){return d(t)(function(t,e,r){return t.merge(S({},r,n(e)))},A.from({}))}}function y(t,n){return function(e){return e.merge({attributes:e.attributes.merge(S({},t,n))})}}function m(t){return function(n){return n.merge({attributes:d(t.attributes)(function(t,n,e){var r=t[e];return null!=r?t.set(e,u(n)(r)):t.set(e,n)},n.attributes)})}}function g(t){return function(n){return n.merge({attributes:h(n.attributes)(c(t))})}}function v(t){return function(n){return n.merge({attributes:h(n.attributes)(l(t))})}}function b(){return A.from({attributes:A.from({})})}function w(t){return function(n){var e=n.asMutable();return e.currentIteration<=e.wait&&(e.currentIteration=e.currentIteration+t),e.currentIteration>0&&!e.called?(e.hook(),e.called=!0):e.currentIteration===n.currentIteration&&e.looping&&(e.currentIteration=0-e.delay,e.called=!1),A.from(e)}}function O(t){return function(n){return n.merge({looping:!0,wait:t.totalDuration-n.delay})}}function j(t,n,e){return A.from(_({},C,{hook:t,currentIteration:n,delay:e}))}function P(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=null==t.delay?$:t.delay,e=null==t.easingFunction?V:t.easingFunction,r=null==t.duration?H:t.duration;return{defaultDelay:n,defaultEase:e,defaultDuration:r}}function I(t,n,e,r,i,u,c){t-=n;var l=o(0-(e.delay+r.delay),t,0-t,e.duration,e.easingFunction,e.delay+r.delay),s=a(l)(f(n)),p=y(i,s)(b()),d=new Map;return d.set(u,p),M(d)(c)}function M(t){return function(n){var e=new Map(n.entries());return t.forEach(function(t,n){e.has(n)?e.set(n,m(t)(e.get(n))):e.set(n,t)}),e}}function E(t){function n(t){return{delay:null==t.delay?S.defaults.delay:t.delay,easingFunction:null==t.easingFunction?S.defaults.easingFunction:t.easingFunction,duration:null==t.duration?S.defaults.duration:t.duration}}function e(t,n){var i=new Map,o=d(n)(function(t,n,e){return y(e,f(n))(t)},b());return i.set(t,o),S.elementMap=M(i)(S.elementMap),{add:r,set:e}}function r(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:z;return i(t,n,e,Y(),new Map,[])}function i(t,e,r,i,a,c){var l=n(r);return Object.keys(e).forEach(function(n){var r=e[n],u=o(t,n,a);null!=u&&(a=I(u,r,l,i,n,t,a))}),i.currentDuration=Math.max(i.currentDuration,l.delay+l.duration),u(i,a,c)}function o(t,n,e){var r=e.get(t),i=S.elementMap.get(t);if(null!=r&&null!=r.attributes&&null!=r.attributes[n]){var o=r.attributes[n];if(null!=o)return o.model}else{if(null==i||null==i.attributes||null==i.attributes[n])throw new Error(t+" does not have "+n+" set");var a=i.attributes[n];if(null!=a)return a.model}}function a(t,n,e,r){var i=j(t,0-n.delay,n.delay);return u(n,e,r.concat([i]))}function u(t,n,e){return{start:h(n,e),loop:s(t,n,e),add:l(t,n,e),then:c(t,n,e),hook:p(t,n,e)}}function c(t,n,e){return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=t.totalDuration+t.currentDuration+r,o={totalDuration:i,delay:i,currentDuration:0};return{add:l(o,n,e),hook:p(o,n,e)}}}function l(t,n,e){return function(r,o){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:z;return i(r,o,a,t,n,e)}}function s(t,n,e){return function(){var r=Object.assign(t,{totalDuration:t.totalDuration+t.currentDuration}),i=Array.from(n.entries()).reduce(function(t,n){var e=R(n,2),i=e[0],o=e[1];return t.set(i,v(r)(o)),t},new Map),o=e.map(O(r));return{start:h(i,o)}}}function p(t,n,e){return function(r){return a(r,t,n,e)}}function h(t,n){return function(){S.elementMap=M(t)(S.elementMap),S.hooks=S.hooks.concat(n),k()}}function m(t){var n=t-S.previousTime;S.firstFrame&&(n=J,S.firstFrame=!1);var e=n/J;S.previousTime=t,S.ticking=!1;var r=D(e,S.elementMap,S.hooks),i=R(r,2),o=i[0],a=i[1];S.hooks=a,S.elementMap=o,E(),k()}function E(){S.elementMap.forEach(function(t,n){S.registry.callRenderPlugins(n,t)})}function k(){if(!S.ticking){var t=S.registry.timingPlugin;if(null==t)throw new Error("Attempted to animate without providing a Timing Plugin");t(m),S.ticking=!0}}function D(t,n,e){var r=e.map(w(t)).filter(function(t,n){return t!==e[n]}),i=Array.from(n.entries()).reduce(function(n,e){var r=R(e,2),i=r[0],o=r[1];return n.set(i,g(t)(o)),n},new Map);return[i,r]}var A=P(t),T=A.defaultDelay,F=A.defaultEase,x=A.defaultDuration,S={ticking:!1,firstFrame:!0,previousTime:0,elementMap:new Map,defaults:{delay:T,easingFunction:F,duration:x},hooks:[],registry:new U},_={add:r,set:e,addPreset:S.registry.addPreset.bind(S.registry),addRenderPlugin:S.registry.addRenderPlugin.bind(S.registry),addTimingPlugin:S.registry.addTimingPlugin.bind(S.registry)};return _}var k="undefined"!=typeof window?window:"undefined"!=typeof global?global:this,D=t(function(t,n,e){!function(){function r(t,n,e){Object.defineProperty(t,n,{enumerable:!1,configurable:!1,writable:!1,value:e})}function i(t,n){r(t,n,function(){throw new l("The "+n+" method cannot be invoked on an Immutable data structure.")})}function o(t){r(t,$,!0)}function a(t){return"object"!=typeof t||(null===t||Boolean(Object.getOwnPropertyDescriptor(t,$)))}function u(t,n){return t===n||t!==t&&n!==n}function c(t){return!(null===t||"object"!=typeof t||Array.isArray(t)||t instanceof Date)}function l(t){var n=new Error(t);return n.__proto__=l,n}function s(t,n){o(t);for(var e in n)n.hasOwnProperty(e)&&i(t,n[e]);return Object.freeze(t),t}function f(t,n){var e=t[n];r(t,n,function(){return _(e.apply(t,arguments))})}function p(t,n,e){var r=e&&e.deep;if(t in this&&(r&&this[t]!==n&&c(n)&&c(this[t])&&(n=this[t].merge(n,{deep:!0,mode:"replace"})),u(this[t],n)))return this;var i=b.call(this);return i[t]=_(n),h(i)}function d(t,n,e){var r=t[0];if(1===t.length)return p.call(this,r,n,e);var i,o=t.slice(1),a=this[r];if("object"==typeof a&&null!==a&&"function"==typeof a.setIn)i=a.setIn(o,n);else{var u=o[0];i=""!==u&&isFinite(u)?d.call(B,o,n):M.call(q,o,n)}if(r in this&&a===i)return this;var c=b.call(this);return c[r]=i,h(c)}function h(t){for(var n in J)if(J.hasOwnProperty(n)){var e=J[n];f(t,e)}r(t,"flatMap",g),r(t,"asObject",w),r(t,"asMutable",b),r(t,"set",p),r(t,"setIn",d),r(t,"update",k),r(t,"updateIn",A);for(var i=0,o=t.length;i<o;i++)t[i]=_(t[i]);return s(t,z)}function y(t){return r(t,"asMutable",m),s(t,N)}function m(){return new Date(this.getTime())}function g(t){if(0===arguments.length)return this;var n,e=[],r=this.length;for(n=0;n<r;n++){var i=t(this[n],n,this);Array.isArray(i)?e.push.apply(e,i):e.push(i)}return h(e)}function v(t){if("undefined"==typeof t&&0===arguments.length)return this;if("function"!=typeof t){var n=Array.isArray(t)?t.slice():Array.prototype.slice.call(arguments);n.forEach(function(t,n,e){"number"==typeof t&&(e[n]=t.toString())}),t=function(t,e){return n.indexOf(e)!==-1}}var e=this.instantiateEmptyObject();for(var r in this)this.hasOwnProperty(r)&&t(this[r],r)===!1&&(e[r]=this[r]);return x(e,{instantiateEmptyObject:this.instantiateEmptyObject})}function b(t){var n,e,r=[];if(t&&t.deep)for(n=0,e=this.length;n<e;n++)r.push(O(this[n]));else for(n=0,e=this.length;n<e;n++)r.push(this[n]);return r}function w(t){"function"!=typeof t&&(t=function(t){return t});var n,e={},r=this.length;for(n=0;n<r;n++){var i=t(this[n],n,this),o=i[0],a=i[1];e[o]=a}return x(e)}function O(t){return!t||"object"!=typeof t||!Object.getOwnPropertyDescriptor(t,$)||t instanceof Date?t:t.asMutable({deep:!0})}function j(t,n){for(var e in t)Object.getOwnPropertyDescriptor(t,e)&&(n[e]=t[e]);return n}function P(t,n){function e(t,e,r){var o=_(e[r]),a=f&&f(t[r],o,n),s=t[r];if(void 0!==i||void 0!==a||!t.hasOwnProperty(r)||!u(o,s)){var p;p=a?a:l&&c(s)&&c(o)?s.merge(o,n):o,u(s,p)&&t.hasOwnProperty(r)||(void 0===i&&(i=j(t,t.instantiateEmptyObject())),i[r]=p)}}function r(t,n){for(var e in t)n.hasOwnProperty(e)||(void 0===i&&(i=j(t,t.instantiateEmptyObject())),delete i[e])}if(0===arguments.length)return this;if(null===t||"object"!=typeof t)throw new TypeError("Immutable#merge can only be invoked with objects or arrays, not "+JSON.stringify(t));var i,o,a=Array.isArray(t),l=n&&n.deep,s=n&&n.mode||"merge",f=n&&n.merger;if(a)for(var p=0,d=t.length;p<d;p++){var h=t[p];for(o in h)h.hasOwnProperty(o)&&e(void 0!==i?i:this,h,o)}else{for(o in t)Object.getOwnPropertyDescriptor(t,o)&&e(this,t,o);"replace"===s&&r(this,t)}return void 0===i?this:x(i,{instantiateEmptyObject:this.instantiateEmptyObject})}function I(t,n){var e=n&&n.deep;if(0===arguments.length)return this;if(null===t||"object"!=typeof t)throw new TypeError("Immutable#replace can only be invoked with objects or arrays, not "+JSON.stringify(t));return this.merge(t,{deep:e,mode:"replace"})}function M(t,n,e){var r=t[0];if(1===t.length)return E.call(this,r,n,e);var i,o=t.slice(1),a=this[r];if(i=this.hasOwnProperty(r)&&"object"==typeof a&&null!==a&&"function"==typeof a.setIn?a.setIn(o,n):M.call(q,o,n),this.hasOwnProperty(r)&&a===i)return this;var u=j(this,this.instantiateEmptyObject());return u[r]=i,x(u,this)}function E(t,n,e){var r=e&&e.deep;if(this.hasOwnProperty(t)&&(r&&this[t]!==n&&c(n)&&c(this[t])&&(n=this[t].merge(n,{deep:!0,mode:"replace"})),u(this[t],n)))return this;var i=j(this,this.instantiateEmptyObject());return i[t]=_(n),x(i,this)}function k(t,n){var e=Array.prototype.slice.call(arguments,2),r=this[t];return this.set(t,n.apply(r,[r].concat(e)))}function D(t,n){for(var e=0,r=n.length;null!=t&&e<r;e++)t=t[n[e]];return e&&e==r?t:void 0}function A(t,n){var e=Array.prototype.slice.call(arguments,2),r=D(this,t);return this.setIn(t,n.apply(r,[r].concat(e)))}function T(t){var n,e=this.instantiateEmptyObject();if(t&&t.deep)for(n in this)this.hasOwnProperty(n)&&(e[n]=O(this[n]));else for(n in this)this.hasOwnProperty(n)&&(e[n]=this[n]);return e}function F(){return{}}function x(t,n){var e=n&&n.instantiateEmptyObject?n.instantiateEmptyObject:F;return r(t,"merge",P),r(t,"replace",I),r(t,"without",v),r(t,"asMutable",T),r(t,"instantiateEmptyObject",e),r(t,"set",E),r(t,"setIn",M),r(t,"update",k),r(t,"updateIn",A),s(t,H)}function S(t){return"object"==typeof t&&null!==t&&(t.$$typeof===V||t.$$typeof===U)}function _(t,n,e){if(a(t)||S(t))return t;if(Array.isArray(t))return h(t.slice());if(t instanceof Date)return y(new Date(t.getTime()));var r=n&&n.prototype,i=r&&r!==Object.prototype?function(){return Object.create(r)}:F,o=i();if(null==e&&(e=64),e<=0)throw new l("Attempt to construct Immutable from a deeply nested object was detected. Have you tried to wrap an object with circular references (e.g. React element)? See https://github.com/rtfeldman/seamless-immutable/wiki/Deeply-nested-object-was-detected for details.");e-=1;for(var u in t)Object.getOwnPropertyDescriptor(t,u)&&(o[u]=_(t[u],void 0,e));return x(o,{instantiateEmptyObject:i})}function R(t){function n(){var n=[].slice.call(arguments),e=n.shift();return t.apply(e,n)}return n}function C(t,n){function e(){var e=[].slice.call(arguments),r=e.shift();return Array.isArray(r)?n.apply(r,e):t.apply(r,e)}return e}var U="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element"),V=60103,$="__immutable_invariants_hold",H=["setPrototypeOf"],Y=["keys"],z=H.concat(["push","pop","sort","splice","shift","unshift","reverse"]),J=Y.concat(["map","filter","slice","concat","reduce","reduceRight"]),N=H.concat(["setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear"]);l.prototype=Error.prototype;var B=_([]),q=_({});_.from=_,_.isImmutable=a,_.ImmutableError=l,_.merge=R(P),_.replace=R(I),_.without=R(v),_.asMutable=C(T,b),_.set=C(E,p),_.setIn=C(M,d),_.update=R(k),_.updateIn=R(A),_.flatMap=R(g),_.asObject=R(w),Object.freeze(_),"object"==typeof t?t.exports=_:"object"==typeof n?n.Immutable=_:"object"==typeof window?window.Immutable=_:"object"==typeof e&&(e.Immutable=_)}()}),A=D&&"object"==typeof D&&"default"in D?D.default:D,T={looping:!1,wait:0},F=(function(){function t(t){this.value=t}function n(n){function e(t,n){return new Promise(function(e,i){var u={key:t,arg:n,resolve:e,reject:i,next:null};a?a=a.next=u:(o=a=u,r(t,n))})}function r(e,o){try{var a=n[e](o),u=a.value;u instanceof t?Promise.resolve(u.value).then(function(t){r("next",t)},function(t){r("throw",t)}):i(a.done?"return":"normal",a.value)}catch(t){i("throw",t)}}function i(t,n){switch(t){case"return":o.resolve({value:n,done:!0});break;case"throw":o.reject(n);break;default:o.resolve({value:n,done:!1})}o=o.next,o?r(o.key,o.arg):a=null}var o,a;this._invoke=e,"function"!=typeof n.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(n.prototype[Symbol.asyncIterator]=function(){return this}),n.prototype.next=function(t){return this._invoke("next",t)},n.prototype.throw=function(t){return this._invoke("throw",t)},n.prototype.return=function(t){return this._invoke("return",t)},{wrap:function(t){return function(){return new n(t.apply(this,arguments))}},await:function(n){return new t(n)}}}(),function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}),x=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),S=function(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t},_=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},R=function(){function t(t,n){var e=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return e}return function(n,e){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return t(n,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),C={looping:!1,called:!1,wait:0},U=function(){function t(){F(this,t),this.renderRegistry={},this.attributePluginMapping={},this.timingPlugin=null}return x(t,[{key:"addRenderPlugin",value:function(t){var n=this,e=t.name,r=t.attributes,i=t.render;this.renderRegistry[e]=i,r.forEach(function(t){null==n.attributePluginMapping[t]&&(n.attributePluginMapping[t]=[]),n.attributePluginMapping[t].push(e)})}},{key:"callRenderPlugins",value:function(t,n){var e=this,r=d(n.attributes)(function(t,n,r){var i=e.attributePluginMapping[r];return null==i?t:(i.forEach(function(e){null==t[e]&&(t[e]={}),t[e][r]=s(n)}),t)},{});p(r).forEach(function(n){var r=R(n,2),i=r[0],o=r[1];e.renderRegistry[i](t,o)})}},{key:"addTimingPlugin",value:function(t){if(null!=this.timingPlugin)throw new Error("A timing plugin was already installed");this.timingPlugin=t}},{key:"addPreset",value:function(t){var n=this,e=t.renderPlugins,r=void 0===e?[]:e,i=t.timingPlugin;r.forEach(function(t){n.addRenderPlugin(t)}),null!=i&&this.addTimingPlugin(i)}}]),t}(),V=function(t,n,e,r){return e*t/r+n},$=0,H=60,Y=function(){return{delay:0,currentDuration:0,totalDuration:0}},z={delay:null,easingFunction:null,duration:null},J=16.67;return E});